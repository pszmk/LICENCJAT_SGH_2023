colnames(studentInfo_DDDJ_v1)
library(rpart)
library(rpart.plot)
library(caret)
setwd("~/LIC_2023/LICENCJAT_SGH_2023")
studentInfo_DDDJ_v1 = read.csv2('../data/studentInfo_DDDJ_v1.csv', sep=',')
studentInfo_DDDJ_v1$'final_result' = as.factor(studentInfo_DDDJ_v1$'final_result')
studentInfo_DDDJ_v1 = subset(studentInfo_DDDJ_v1, selecct = -c(score))
colnames(studentInfo_DDDJ_v1)
type(studentInfo_DDDJ_v1$score)
class(studentInfo_DDDJ_v1$score)
studentInfo_DDDJ_v1 = subset(studentInfo_DDDJ_v1, selecct = -c('score'))
colnames(studentInfo_DDDJ_v1)
studentInfo_DDDJ_v1 = subset(studentInfo_DDDJ_v1, select = -c(score))
colnames(studentInfo_DDDJ_v1)
studentInfo_DDDJ_v1 = read.csv2('../data/studentInfo_DDDJ_v1.csv', sep=',')
studentInfo_DDDJ_v1$'final_result' = as.factor(studentInfo_DDDJ_v1$'final_result')
studentInfo_DDDJ_v1 = subset(studentInfo_DDDJ_v1, select = -c(score, id_student))
colnames(studentInfo_DDDJ_v1)
setwd("~/LIC_2023/LICENCJAT_SGH_2023")
studentInfo_DDDJ_v1 = read.csv2('../data/studentInfo_DDDJ_v1.csv', sep=',')
studentInfo_DDDJ_v1$'final_result' = as.factor(studentInfo_DDDJ_v1$'final_result')
studentInfo_DDDJ_v1 = subset(studentInfo_DDDJ_v1, select = -c(score, id_student, code_presentation))
colnames(studentInfo_DDDJ_v1)
library(rpart)
library(rpart.plot)
library(rpart)
library(rpart.plot)
library(caret)
setwd("~/LIC_2023/LICENCJAT_SGH_2023")
studentInfo_DDDJ_v1 = read.csv2('../data/studentInfo_DDDJ_v1_2.csv', sep=',')
sapply(studentInfo_DDDJ_v1, class)
View(studentInfo_DDDJ_v1)
as.numeric(studentInfo_DDDJ_v1$highest_education)
sapply(studentInfo_DDDJ_v1, class)
studentInfo_DDDJ_v1$highest_education = as.numeric(studentInfo_DDDJ_v1$highest_education)
studentInfo_DDDJ_v1$imd_band = as.numeric(studentInfo_DDDJ_v1$imd_band)
studentInfo_DDDJ_v1$date_submitted = as.numeric(studentInfo_DDDJ_v1$date_submitted)
studentInfo_DDDJ_v1$final_result = as.factor(studentInfo_DDDJ_v1$'final_result')
sapply(studentInfo_DDDJ_v1, class)
?as.integer
studentInfo_DDDJ_v1$highest_education = as.integer(studentInfo_DDDJ_v1$highest_education)
sapply(studentInfo_DDDJ_v1, class)
studentInfo_DDDJ_v1$highest_education = as.integer(studentInfo_DDDJ_v1$highest_education)
studentInfo_DDDJ_v1$imd_band = as.integer(studentInfo_DDDJ_v1$imd_band)
studentInfo_DDDJ_v1$date_submitted = as.integer(studentInfo_DDDJ_v1$date_submitted)
studentInfo_DDDJ_v1$final_result = as.factor(studentInfo_DDDJ_v1$'final_result')
sapply(studentInfo_DDDJ_v1, class)
studentInfo_DDDJ_v1$age_band = as.integer(studentInfo_DDDJ_v1$age_band)
sapply(studentInfo_DDDJ_v1, class)
studentInfo_DDDJ_v1$region = as.factor(studentInfo_DDDJ_v1$region)
sapply(studentInfo_DDDJ_v1, class)
setwd("~/LIC_2023/LICENCJAT_SGH_2023")
studentInfo_DDDJ_v1 = read.csv2('../data/studentInfo_DDDJ_v1_2.csv', sep=',')
studentInfo_DDDJ_v1 = subset(studentInfo_DDDJ_v1, select = -c(score, id_student, code_presentation))
sapply(studentInfo_DDDJ_v1, class)
studentInfo_DDDJ_v1 = read.csv2('../data/studentInfo_DDDJ_v1_2.csv', sep=',')
studentInfo_DDDJ_v1 = subset(studentInfo_DDDJ_v1, select = -c('score', 'id_student', 'code_presentation'))
studentInfo_DDDJ_v1
sapply(studentInfo_DDDJ_v1, class)
studentInfo_DDDJ_v1 = subset(studentInfo_DDDJ_v1, select = c('score', 'id_student', 'code_presentation'))
sapply(studentInfo_DDDJ_v1, class)
subset(studentInfo_DDDJ_v1, select = c('score', 'id_student', 'code_presentation'))
studentInfo_DDDJ_v1 = subset(studentInfo_DDDJ_v1, select = c("score", 'id_student', 'code_presentation'))
studentInfo_DDDJ_v1 = subset(studentInfo_DDDJ_v1, select = c("score", 'id_student', 'code_presentation'))
sapply(studentInfo_DDDJ_v1, class)
selected_colnames = c('X', 'final_result', 'region', 'highest_education', 'imd_band', 'age_band',
'studied_credits', 'date_submitted',
'code_presentation_2014J', 'gender_M', 'disability_Y')
studentInfo_DDDJ_v1 = subset(studentInfo_DDDJ_v1, select = selected_colnames)
sapply(studentInfo_DDDJ_v1, class)
studentInfo_DDDJ_v1$highest_education = as.integer(studentInfo_DDDJ_v1$highest_education)
studentInfo_DDDJ_v1$age_band = as.integer(studentInfo_DDDJ_v1$age_band)
studentInfo_DDDJ_v1$imd_band = as.integer(studentInfo_DDDJ_v1$imd_band)
studentInfo_DDDJ_v1$date_submitted = as.integer(studentInfo_DDDJ_v1$date_submitted)
studentInfo_DDDJ_v1$final_result = as.factor(studentInfo_DDDJ_v1$final_result)
studentInfo_DDDJ_v1$region = as.factor(studentInfo_DDDJ_v1$region)
#studentInfo_DDDJ_v1$score = as.numeric(studentInfo_DDDJ_v1$score)
sapply(studentInfo_DDDJ_v1, class)
studentInfo_DDDJ_v1
colnames(studentInfo_DDDJ_v1)
selected_colnames = c('final_result', 'region', 'highest_education', 'imd_band', 'age_band',
'studied_credits', 'date_submitted',
'code_presentation_2014J', 'gender_M', 'disability_Y')
studentInfo_DDDJ_v1 = subset(studentInfo_DDDJ_v1, select = selected_colnames)
sapply(studentInfo_DDDJ_v1, class)
studentInfo_DDDJ_v1
#studentInfo_DDDJ_v1$score = as.numeric(studentInfo_DDDJ_v1$score)
sapply(studentInfo_DDDJ_v1, class)
colnames(studentInfo_DDDJ_v1)
set.seed(42)
train_indexes = createDataPartition(studentInfo_DDDJ_v1$final_result, p=.9, list=FALSE)
studentInfo_train = studentInfo_DDDJ_v1[train_indexes,]
studentInfo_test = studentInfo_DDDJ_v1[-train_indexes,]
nrow(studentInfo_DDDJ_v1)
nrow(studentInfo_train)
nrow(studentInfo_test)
# nie tykać bo się wytrenowało długo
tree.0.1 = rpart(final_result ~ ., data=studentInfo_train, control = list(maxdepth=20))
rpart.plot(tree.0.1, under=FALSE, tweak=1.3, fallen.leaves=TRUE)
rpart.plot(tree.0.1)
rpart.plot(tree.0.1, box.palette="blue")
summary(studentInfo_train)
# nie tykać bo się wytrenowało długo
tree.0.1 = rpart(final_result ~  region, #'highest_education', 'imd_band', 'age_band', 'studied_credits', 'date_submitted', 'code_presentation_2014J', 'gender_M', 'disability_Y'
, data=studentInfo_train, control = list(maxdepth=20))
rpart.plot(tree.0.1, box.palette="blue")
# nie tykać bo się wytrenowało długo
tree.0.1 = rpart(final_result ~  region, #'highest_education', 'imd_band', 'age_band', 'studied_credits', 'date_submitted', 'code_presentation_2014J', 'gender_M', 'disability_Y'
data=studentInfo_train, control = list(maxdepth=20))
rpart.plot(tree.0.1, box.palette="blue")
rpart.plot(tree.0.1, box.palette="blue")
# nie tykać bo się wytrenowało długo
tree.0.1 = rpart(final_result ~  region, #'highest_education', 'imd_band', 'age_band', 'studied_credits', 'date_submitted', 'code_presentation_2014J', 'gender_M', 'disability_Y'
data=studentInfo_train)#, control = list(maxdepth=20))
rpart.plot(tree.0.1, box.palette="blue")
source('useful_things.R')
colnames(studentInfo_DDDJ_v1)
draw_plots(data=studentInfo_train,
varname = colnames(studentInfo_DDDJ_v1)[0])
source('useful_things.R')
studentInfo_DDDJ_v1 = read.csv2('../data/studentInfo_DDDJ_v1_2.csv', sep=',')
selected_colnames = c('final_result', 'region', 'highest_education', 'imd_band', 'age_band',
'studied_credits', 'date_submitted',
'code_presentation_2014J', 'gender_M', 'disability_Y')
selected_colnames = c('final_result', 'region', 'highest_education', 'imd_band', 'age_band',
'studied_credits', 'date_submitted',
'code_presentation_2014J', 'gender_M', 'disability_Y', 'score')
studentInfo_DDDJ_v1 = subset(studentInfo_DDDJ_v1, select = selected_colnames)
sapply(studentInfo_DDDJ_v1, class)
studentInfo_DDDJ_v1$highest_education = as.integer(studentInfo_DDDJ_v1$highest_education)
studentInfo_DDDJ_v1$age_band = as.integer(studentInfo_DDDJ_v1$age_band)
studentInfo_DDDJ_v1$imd_band = as.integer(studentInfo_DDDJ_v1$imd_band)
studentInfo_DDDJ_v1$date_submitted = as.integer(studentInfo_DDDJ_v1$date_submitted)
studentInfo_DDDJ_v1$final_result = as.factor(studentInfo_DDDJ_v1$final_result)
studentInfo_DDDJ_v1$region = as.factor(studentInfo_DDDJ_v1$region)
studentInfo_DDDJ_v1$score = as.numeric(studentInfo_DDDJ_v1$score)
studentInfo_DDDJ_v1 = read.csv2('../data/studentInfo_DDDJ_v1_2.csv', sep=',')
selected_colnames = c(#'final_result',
'region', 'highest_education', 'imd_band', 'age_band',
'studied_credits', 'date_submitted',
'code_presentation_2014J', 'gender_M', 'disability_Y', 'score')
studentInfo_DDDJ_v1 = subset(studentInfo_DDDJ_v1, select = selected_colnames)
sapply(studentInfo_DDDJ_v1, class)
studentInfo_DDDJ_v1$highest_education = as.integer(studentInfo_DDDJ_v1$highest_education)
studentInfo_DDDJ_v1$age_band = as.integer(studentInfo_DDDJ_v1$age_band)
studentInfo_DDDJ_v1$imd_band = as.integer(studentInfo_DDDJ_v1$imd_band)
studentInfo_DDDJ_v1$date_submitted = as.integer(studentInfo_DDDJ_v1$date_submitted)
#studentInfo_DDDJ_v1$final_result = as.factor(studentInfo_DDDJ_v1$final_result)
studentInfo_DDDJ_v1$region = as.factor(studentInfo_DDDJ_v1$region)
studentInfo_DDDJ_v1$score = as.numeric(studentInfo_DDDJ_v1$score)
sapply(studentInfo_DDDJ_v1, class)
selected_colnames = c(#'final_result','region',
'highest_education', 'imd_band', 'age_band',
'studied_credits', 'date_submitted',
'code_presentation_2014J', 'gender_M', 'disability_Y', 'score')
sapply(studentInfo_DDDJ_v1, class)
studentInfo_DDDJ_v1$highest_education = as.integer(studentInfo_DDDJ_v1$highest_education)
studentInfo_DDDJ_v1$age_band = as.integer(studentInfo_DDDJ_v1$age_band)
studentInfo_DDDJ_v1$imd_band = as.integer(studentInfo_DDDJ_v1$imd_band)
studentInfo_DDDJ_v1$date_submitted = as.integer(studentInfo_DDDJ_v1$date_submitted)
#studentInfo_DDDJ_v1$final_result = as.factor(studentInfo_DDDJ_v1$final_result)
studentInfo_DDDJ_v1$region = as.factor(studentInfo_DDDJ_v1$region)
studentInfo_DDDJ_v1$score = as.numeric(studentInfo_DDDJ_v1$score)
sapply(studentInfo_DDDJ_v1, class)
colnames(studentInfo_DDDJ_v1)
model.1 = lm(score ~ ., data=studentInfo_DDDJ_v1)
summary(model.1)
#studentInfo_DDDJ_v1$final_result = as.factor(studentInfo_DDDJ_v1$final_result)
#studentInfo_DDDJ_v1$region = as.factor(studentInfo_DDDJ_v1$region)
studentInfo_DDDJ_v1$score = as.numeric(studentInfo_DDDJ_v1$score)
studentInfo_DDDJ_v1 = read.csv2('../data/studentInfo_DDDJ_v1_2.csv', sep=',')
selected_colnames = c(#'final_result','region',
'highest_education', 'imd_band', 'age_band',
'studied_credits', 'date_submitted',
'code_presentation_2014J', 'gender_M', 'disability_Y', 'score')
studentInfo_DDDJ_v1 = subset(studentInfo_DDDJ_v1, select = selected_colnames)
sapply(studentInfo_DDDJ_v1, class)
studentInfo_DDDJ_v1$highest_education = as.integer(studentInfo_DDDJ_v1$highest_education)
studentInfo_DDDJ_v1$age_band = as.integer(studentInfo_DDDJ_v1$age_band)
studentInfo_DDDJ_v1$imd_band = as.integer(studentInfo_DDDJ_v1$imd_band)
studentInfo_DDDJ_v1$date_submitted = as.integer(studentInfo_DDDJ_v1$date_submitted)
#studentInfo_DDDJ_v1$final_result = as.factor(studentInfo_DDDJ_v1$final_result)
#studentInfo_DDDJ_v1$region = as.factor(studentInfo_DDDJ_v1$region)
studentInfo_DDDJ_v1$score = as.numeric(studentInfo_DDDJ_v1$score)
sapply(studentInfo_DDDJ_v1, class)
colnames(studentInfo_DDDJ_v1)
model.1 = lm(score ~ ., data=studentInfo_DDDJ_v1)
summary(model.1)
ggplot(studentInfo_DDDJ_v1)   +
geom_point(
aes( x = age_band, y = score,
col = gender_M ))
colnames(studentInfo_DDDJ_v1)
colnames(studentInfo_DDDJ_v1)
ggplot(studentInfo_DDDJ_v1)   +
geom_point(
aes( x = age_band, y = score,
col = imd_band ))
ggplot(studentInfo_DDDJ_v1)   +
geom_point(
aes( x = highest_education, y = score,
col = imd_band ))
ggplot(studentInfo_DDDJ_v1)   +
geom_point(
aes( x = studied_credits, y = score,
col = imd_band ))
studentInfo_DDDJ_v1 = read.csv2('../data/studentInfo_DDDJ_v1_2.csv', sep=',')
selected_colnames = c('final_result','region',
'highest_education', 'imd_band', 'age_band',
'studied_credits', 'date_submitted',
'code_presentation_2014J', 'gender_M', 'disability_Y', 'score')
studentInfo_DDDJ_v1 = subset(studentInfo_DDDJ_v1, select = selected_colnames)
sapply(studentInfo_DDDJ_v1, class)
studentInfo_DDDJ_v1$highest_education = as.integer(studentInfo_DDDJ_v1$highest_education)
studentInfo_DDDJ_v1$age_band = as.integer(studentInfo_DDDJ_v1$age_band)
studentInfo_DDDJ_v1$imd_band = as.integer(studentInfo_DDDJ_v1$imd_band)
studentInfo_DDDJ_v1$date_submitted = as.integer(studentInfo_DDDJ_v1$date_submitted)
studentInfo_DDDJ_v1$final_result = as.factor(studentInfo_DDDJ_v1$final_result)
#studentInfo_DDDJ_v1$region = as.factor(studentInfo_DDDJ_v1$region)
studentInfo_DDDJ_v1$score = as.numeric(studentInfo_DDDJ_v1$score)
sapply(studentInfo_DDDJ_v1, class)
colnames(studentInfo_DDDJ_v1)
ggplot(studentInfo_DDDJ_v1)   +
geom_point(
aes( x = studied_credits, y = score,
col = final_result ))
ggplot(studentInfo_DDDJ_v1)   +
geom_point(
aes( x = studied_credits, y = highest_education,
col = final_result ))
ggplot(studentInfo_DDDJ_v1)   +
geom_point(
aes( x = studied_credits, y = age_band,
col = final_result ))
colnames(studentInfo_DDDJ_v1)
ggplot(studentInfo_DDDJ_v1)   +
geom_point(
aes( x = region, y = age_band,
col = final_result ))
